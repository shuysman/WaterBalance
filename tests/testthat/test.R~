library(dplyr)
library(magrittr)

frog <- read.csv("./FrogRock-inputforR.csv")
correct <- read.csv("./CorrectVars.csv")

test <- correct %>%
  select(Date)

frog <- frog %>%
  mutate(tmean = (tmin_degC+tmax_degC)/2)

Lat <- 44.95354
Lon <- -110.54083

## Test functions from WB v2 package

frog$jtemp <- as.numeric(get_jtemp(Lon, Lat))

test_that("jtemp_correct", {
    expect_equal(frog$Jennings.factor, frog$jtemp)
    })

frog$freeze <- get_freeze(frog$jtemp, frog$tmean)
test$freeze <- frog$freeze - correct$F
max(test$freeze)

frog$rain <- get_rain(frog$precip_mmday,frog$freeze)
test$RAIN <- frog$rain - correct$RAIN
max(test$RAIN)

frog$snow <- get_snow(frog$precip_mmday, frog$freeze)
test$SNOW <- frog$snow - correct$SNOW
max(test$SNOW)

frog$melt <- get_melt(frog$tmean, frog$jtemp, frog$Hock, frog$snow) #tested to make sure it works with init pack values other than 0
test$MELT <- frog$melt - correct$MELT
max(test$MELT)

frog$snowpack <- get_snowpack(frog$jtemp, frog$snow, frog$melt) #tested to make sure it works with init pack values other than 0
test$PACK <- frog$snowpack - correct$PACK
max(test$PACK)

frog$W <- get_w(frog$rain, frog$melt)
test$W <- frog$W - correct$W
max(test$W)

frog$PET <- get_OudinPET(frog$yday, Lat, frog$snowpack, frog$tmean, slope=2, frog$aspect, shade.coeff = 1)
test$PET <- frog$PET - correct$PET
max(test$PET)

